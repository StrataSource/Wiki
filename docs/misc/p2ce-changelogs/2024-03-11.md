# Portal 2: Community Edition - March 11th, 2024 Update

## Additions (16)
- Added a status indicator for validity of autosave paths in the Hammer options dialog
- Added an overlay plane when using Hammer's Clipping Tool
- Added `buildambientcache` concommand to pack ambient light cache into BSP
- Added 'enable' key to `mounts.kv`, to allow entries to be selectively disabled
- Added new launch arguments, `-display` to select which monitor the game will start on, and `-adapter` to select which GPU the game will render with
- Added new VProf UI, perf counters UI and VProf report generator UI. The old VProf tree UI has been removed in favor of the new UI
- Added `packed_files_list` to view files packed into the BSP
- Added PBR parallax dithering to smooth out the appearance of layers
- Added `strata` and `vgui_green` themes for ImGui
- Added support for AVX/AVX2 (and other modern x86 extensions) in VRAD. If your processor doesn't support it (or if you pass `-noavx`), it will fallback to a more generic version of VRAD
- Added support for continuing demos recordings after disconnect (Requires `demo_autorecord 1`)
- Added support for Ogg and FLAC audio files
- Added theming support for ImGui
- Allowed custom models on `prop_wall_projector`, `prop_tractor_beam`, `prop_personality_core`, `prop_glass_futbol_spawner`, `prop_glass_futbol`, `prop_glass_futbol_socket`
- Fixed Schr√∂dinger cube trying to create its particle each time it was updated
- Running in tools mode will now display `[Tools Mode]` in the window title

## Fixes (43)
- Added `$usecolor` to `paintblob` shader. Allows settings `$color` and `$alpha`
- Fixed a bug causing `ambient_generic` to not use the correct source entity when played using the Toggle input
- Fixed a bug preventing `ambient_generic` entities without the 'Start Silent' flag from playing
- Fixed a crash on exit related to in game videos
- Fixed a rare crash related to triggers failing to access gamerules
- Fixed a rare crash related to view PVS
- Fixed an issue in Legacy UI where changing your persona with a large amount of friends could cause the game to hang
- Fixed `BecomeShortCircuit` forcefully dropping the held entity, even if it's not a monster cube
- Fixed 'black' shader not respecting fog like it should
- Fixed certain datamodel files not loading on Linux
- Fixed console spam on vehicle `ent_text`
- Fixed console spam relating to the portal gun
- Fixed crash when creating a prefab in Hammer
- Fixed crash-on-exit in most utilities on Linux. This was a harmless crash, but annoying nonetheless
- Fixed CSM fading out unintentionally on PBR brushes
- Fixed displacement carve normal direction combobox not having expected entries
- Fixed DX11 swapchain creation failing in some cases
- Fixed dynamic game mounts when running under WINE
- Fixed file lookups on Linux occasionally failing
- Fixed Hammer 3D view selection not working properly with instances
- Fixed Hammer model browser stretching
- Fixed incorrect lighting on PBR shader in some cases
- Fixed issues with horizontally moving platforms in certain maps
- Fixed LightmappedReflective combo error
- Fixed materials being used for ropes and anything else simultaneously sometimes not being drawn (e.g. on surf_arcade)
- Fixed models in Hammer getting randomly colored when the entity didn't have `rendercolor` KV
- Fixed occasional crash when breaking a turret
- Fixed occasional MaterialSystem deadlock when loading maps
- Fixed packing of certain files into VPKs with `vpk.exe`
- Fixed Particle Editor crash when adding a new operator
- Fixed PBR parallax using texture coordinates from the layer below the correct one
- Fixed some objects not rendering in Hammer 2D views
- Fixed tools mode closing/swapping input when scrolling with the mouse
- Fixed `trigger_changelevel` not working for HL2 maps (Thanks AlexEpisode!)
- Fixed vehicles crashing if their script is null
- Fixed VGUI `movie_display_screen` trying to create a video material every frame when it fails to load
- Fixed Wheatley's flashlight in `sp_s2_bts3`
- Fixed window size bug on Linux
- Fixed WVT and PBR materials not rendering properly when used on displacements
- Load `gameevents.res` and `modevents.res` from the MOD search path instead of GAME. Previously, custom folder and workshop addons could unintentionally break things
- Re-enable `$depthblend` in SpriteCard shader
- Use non-native file selector for instances when running Hammer under WINE
- Use the Strata icon for the engine instead of the old Chaos icon

## Improvements (30)
- Added new categorization method for ImGui windows. Should be easier to navigate now
- Cleaned up some console spam
- Commands and ConVars marked as `notindemo`, but still present in older demos, can no longer be executed by demos
- Controller glyphs in VGUI menus are now based on controller Steam detected
- Creating displacement from brush entities in Hammer will now move the solid to world
- Hammer entity properties dialog will now set origin when creating brush entities
- Hammer Texture Browser now stores state of its filters
- Hid some potentially buggy debug console commands
- HLMV link mode now syncs light state and colors
- HLMV now uses the same audio system as the game. This allows sound operators and more to function correctly
- Improved behavior of `vpk.exe` on Windows
- Improved compile times on models with large amounts of flexes
- Improved Hammer Entity IO stability
- Improved L4D1 and ASW model compatiblity
- Improved loading times for when using many search paths
- Improved performance when resizing the game window
- Improved support for MP3 audio files by replacing minimp3 with libsndfile
- Load `dsp_presets.txt` from MOD path
- Load `particles_manifest.txt` from MOD search path. This is to prevent workshop addons overriding it. The additional BSP-packed `particles_manifest.txt` is unaffected by this change
- Marked most commands related to saving, loading, connecting, disconnecting, or map changing as `notindemo`
- Merged `client.dll` and `client_legacyui.dll`
- Removed brickbat ConVars
- Removed `npc_assassin`
- Removed the launch argument `-debugstartupscreen`
- Removed the requirement on `materials/console/startup_loading.vtf` and `materials/vgui/portal2logo.vtf` files
- Replaced most Hammer MFC message boxes with Qt message boxes
- SAPI phonemeextractor can now actually extract phonemes
- Static prop ambient light cache is now stored automatically, and `-storeambientcache` has been removed
- The ambient light cache is now rebuilt for changes in map revision
- The ambient light cache version has been increased to 3

## VScript (5)
- Added ImGui based VScript consoles for server and client, for debugging purposes
- Added `CBasePortal` with the following methods: `GetPartner` `GetPortalNumber` `GetHalfWidth` `GetHalfHeight` `IsMobile` `IsOpen`
- Added `CPropPortal` (Inherits from `CBasePortal`) with the following methods: `SetActivatedState` `Resize` `Fizzle` `NewLocation` `SetLinkageGroupID` `GetLinkageGroupID` `GetFiredByPlayer`
- Added global `FindPortalByID` to find portal by linkage ID and number, respectively (1=primary, 2=secondary)
- Fixed a VScript crash related to bad function calls with default arguments

## Panorama (10)
- Added `GameInterfaceAPI.GetCurrentMap()`
- Fixed crash when `ContextMenuFadoutTime` is undefined
- Improved Panorama stability and logging
- Removed the `Chaos` prefix from any Panorama panels that had it. `ChaosHud` is now `HUD`, `ChaosMainMenu` is now `MainMenu`, and so on
- Removed the `Chaos` prefix from any Panorama events that had it. `ChaosFrameUpdate` is now `FrameUpdate`, `ChaosShowIntroMovie` is now `ShowIntroMovie`, and so on
- Renamed `chaos_hud_menu_show` command to `hud_menu_show`
- Renamed `chaos_hud_menu_hide` command to `hud_menu_hide`
- Renamed `chaos_hud_menu_reload` command to `hud_menu_reload`
- Removed `ChaosPopupManager` from Panorama. Use `PopupManager` instead
- Removed `ChaosTooltipManager` from Panorama. Use `TooltipManager` instead
